<!DOCTYPE html>
<html>
<head>
    <title>Async/Await Practice</title>
    <style>
        .user-card { 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
            background: white;
        }
        .loading { opacity: 0.6; }
        .error { border-color: #f44336; background: #ffebee; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è≥ –ü—Ä–∞–∫—Ç–∏–∫–∞ —Å async/await</h1>
        
        <button class="button success" id="loadUserBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <button class="button info" id="parallelBtn">–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</button>
        <button class="button error" id="errorHandlingBtn">–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</button>
        
        <div id="userContainer"></div>
        <div class="log" id="log2"></div>
    </div>

    <script>
        const userContainer = document.getElementById('userContainer');
        const log2 = document.getElementById('log2');

        function addLog2(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.style.borderLeftColor = type === 'error' ? '#f44336' : 
                                        type === 'success' ? '#4CAF50' : '#2196F3';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log2.appendChild(entry);
        }

        // üìå –ò–ú–ò–¢–ê–¶–ò–Ø API-–ó–ê–ü–†–û–°–û–í
        function fakeApiRequest(data, delay = 1000, shouldFail = false) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (shouldFail) {
                        reject(new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${data}`));
                    } else {
                        resolve({ data, timestamp: new Date().toLocaleTimeString() });
                    }
                }, delay);
            });
        }

        // üìå 1. –ë–ê–ó–û–í–û–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï async/await
        document.getElementById('loadUserBtn').addEventListener('click', async function() {
            addLog2('--- –ó–ê–ì–†–£–ó–ö–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (async/await) ---');
            
            try {
                // üîπ async —Ñ—É–Ω–∫—Ü–∏—è –í–°–ï–ì–î–ê –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Promise
                // üîπ await –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–û–õ–¨–ö–û –≤–Ω—É—Ç—Ä–∏ async —Ñ—É–Ω–∫—Ü–∏–π
                
                addLog2('1. –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                
                // await "–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç" –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Promise
                const user = await fakeApiRequest('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 1500);
                addLog2(`2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω: ${user.data}`, 'success');
                
                addLog2('3. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å...');
                const profile = await fakeApiRequest('–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 1000);
                addLog2(`4. –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω: ${profile.data}`, 'success');
                
                addLog2('5. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏...');
                const settings = await fakeApiRequest('–ù–∞—Å—Ç—Ä–æ–π–∫–∏', 800);
                addLog2(`6. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${settings.data}`, 'success');
                
                // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                userContainer.innerHTML = `
                    <div class="user-card">
                        <h3>‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!</h3>
                        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.data}</p>
                        <p>–ü—Ä–æ—Ñ–∏–ª—å: ${profile.data}</p>
                        <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${settings.data}</p>
                        <p>–í—Ä–µ–º—è: ${user.timestamp}</p>
                    </div>
                `;
                
            } catch (error) {
                addLog2(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                userContainer.innerHTML = `
                    <div class="user-card error">
                        <h3>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        });

        // üìå 2. –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û–ï –í–´–ü–û–õ–ù–ï–ù–ò–ï –° Promise.all()
        document.getElementById('parallelBtn').addEventListener('click', async function() {
            addLog2('--- –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê ---');
            
            try {
                addLog2('–ó–∞–ø—É—Å–∫–∞–µ–º 3 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞...');
                
                // üîπ Promise.all() –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –í–°–ï–• –ø—Ä–æ–º–∏—Å–æ–≤
                // üîπ –ó–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (—ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è)
                const [users, products, orders] = await Promise.all([
                    fakeApiRequest('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 2000),
                    fakeApiRequest('–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤', 1500),
                    fakeApiRequest('–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤', 1800)
                ]);
                
                addLog2('‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!', 'success');
                addLog2(`‚Ä¢ ${users.data} (${users.timestamp})`);
                addLog2(`‚Ä¢ ${products.data} (${products.timestamp})`);
                addLog2(`‚Ä¢ ${orders.data} (${orders.timestamp})`);
                
            } catch (error) {
                addLog2(`‚ùå –û–¥–∏–Ω –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π: ${error.message}`, 'error');
            }
        });

        // üìå 3. –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö –í async/await
        document.getElementById('errorHandlingBtn').addEventListener('click', async function() {
            addLog2('--- –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö ---');
            
            try {
                addLog2('1. –ó–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ...');
                const successData = await fakeApiRequest('–£—Å–ø–µ—à–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 1000);
                addLog2(`‚úÖ ${successData.data}`, 'success');
                
                addLog2('2. –ó–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ó–ê–í–ï–†–®–ò–¢–°–Ø –û–®–ò–ë–ö–û–ô...');
                const failedData = await fakeApiRequest('–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 1000, true);
                // –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –≤—ã—à–µ
                addLog2('–≠—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã –Ω–µ —É–≤–∏–¥–∏—Ç–µ...');
                
            } catch (error) {
                /* 
                üîπ –ë–õ–û–ö catch –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –õ–Æ–ë–£–Æ –æ—à–∏–±–∫—É –≤ try –±–ª–æ–∫–µ
                üîπ –û—à–∏–±–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑ await –∏–ª–∏ –æ–±—ã—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
                */
                addLog2(`‚ùå –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞ –æ—à–∏–±–∫–∞: ${error.message}`, 'error');
                
                // –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                addLog2('3. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏...');
                const recoveryData = await fakeApiRequest('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 800);
                addLog2(`‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: ${recoveryData.data}`, 'success');
            } finally {
                // üîπ finally –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –í–°–ï–ì–î–ê
                addLog2('üèÅ –ë–ª–æ–∫ finally: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏');
            }
        });
    </script>
</body>
</html>